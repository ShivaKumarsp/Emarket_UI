<ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-scale-multiple">
  <p style="font-size: 20px; color: white">Loading...</p>
</ngx-spinner>
<section class="hero hero-page gray-bg padding-small">
  <div class="container">
    <div class="row d-flex">
      <div class="col-lg-9 order-2 order-lg-1">
        <h1>Edit Item</h1>
      </div>
      <div class="col-lg-3 text-right order-1 order-lg-2">
        <ul class="breadcrumb justify-content-lg-end">
          <li class="breadcrumb-item"><a>Home</a></li>
          <li class="breadcrumb-item active">Edit Item</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<section class="checkout">
  <div class="container">
    <div class="row">
      <div class="col-12 mb-4">
        <ul class="nav nav-pills">

          <li class="nav-item"><a class="nav-link active">Edit Item</a></li>
          <li class="nav-item"><a class="nav-link">Item Specification </a></li>
          <li class="nav-item"><a class="nav-link">Item Feature</a></li>
        </ul>
      </div>
      <div class="col-md-8">

        <div class="tab-content">
          <div id="product_info" class="active">

            <form name="additemform" [formGroup]="form">
              <div class="row">

                <div class="col-md-6 p-2">
                  <label class="form-label">Product Name<b style="color: red;">*</b></label>
                  <select class="form-control" formControlName="v_productid" [(ngModel)]="product_id"
                    (change)="getimg(product_id)" [ngClass]="{ 'is-invalid': submitted && f['v_productid'].errors }">
                    <option value="">--Select Product Name--</option>
                    <option *ngFor="let product of productlist" value="{{product.productid}}"
                      selected="product.productid == product_id">
                      {{product.productname}}
                    </option>
                  </select>


                  <div *ngIf="submitted && f['v_productid'].errors" lass="invalid-feedback">
                    <div *ngIf="f['v_productid'].errors['required']">Select Products</div>
                  </div>
                </div>

                <div class="col-md-6 p-2">
                  <label class="form-label">Item Type<b style="color: red;">*</b></label>
                  <select class="form-control" formControlName="v_item_type" [(ngModel)]="item_type_id"
                    [ngClass]="{ 'is-invalid': submitted && f['v_item_type'].errors }">
                    <option disabled>-- Select item Type --</option>
                    <option *ngFor="let itemtype of producttypelist" [ngValue]="itemtype.producttypeid">
                      {{itemtype.producttypename}}
                    </option>
                  </select>
                  <div *ngIf="submitted && f['v_item_type'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_item_type'].errors['required']">Select Item Type</div>
                  </div>
                </div>
                <div class="col-md-6 form-group mb-3 p-2" *ngIf="product_id!=''">
                  <label class="form-label">HSN Code</label>
                  <input formControlName="hsn" type="text" class="form-control" 
                   placeholder="HSN Code" [(ngModel)]="hsn_code">
                  </div>

                  <div class="col-md-6 form-group mb-3 p-2" *ngIf="product_id!=''">
                    <label class="form-label">GST %</label>
                    <input formControlName="gst" type="text" class="form-control" 
                     placeholder="GST %" [(ngModel)]="gst_percentage">
                    </div>
                    

                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Item Name<b style="color: red;">*</b></label>
                  <input type="text" formControlName="v_itemname" class="form-control" [(ngModel)]="item_name"
                    minlength="5" maxlength="300" (keypress)="keyPressSpace($event)" placeholder="Enter Item Name"
                    [ngClass]="{ 'is-invalid': submitted && f['v_itemname'].errors }">
                  <div *ngIf="submitted && f['v_itemname'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_itemname'].errors['required']">Enter Item Name</div>

                    <div style="color: red;" *ngIf="v_itemname.errors?.['minlength']">
                      Minimum 5 Character
                    </div>
                  </div>
                </div>


                <div class="col-md-6  mb-3">
                  <label class="form-label">Store Name<b style="color: red;">*</b></label>
                  <select class="form-control" formControlName="v_storename" [(ngModel)]="store_id"
                    [ngClass]="{ 'is-invalid': submitted && f['v_storename'].errors }">
                    <option value="">-- Select Store --</option>
                    <option *ngFor="let store of storelist" [ngValue]="store.storeid">
                      {{store.storename}}
                    </option>
                  </select>
                  <div *ngIf="submitted && f['v_storename'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_storename'].errors['required']">Select Store Name</div>
                  </div>
                </div>

                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">MRP<b style="color: red;">*</b></label>
                  <input formControlName="v_item_mrp" type="number" placeholder="Set MRP" class="form-control" min="1"
                    [(ngModel)]="mrp" [ngClass]="{ 'is-invalid': submitted && f['v_item_mrp'].errors }"
                    onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
                  <div *ngIf="submitted && f['v_item_mrp'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_item_mrp'].errors['required']">Set MRP</div>
                    <div style="color: red;" *ngIf="v_item_mrp.errors?.['min']">
                      Minimum 1 Rupee
                    </div>
                  </div>
                </div>

                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Listing Price<b style="color: red;">*</b></label>
                  <input formControlName="v_item_list_price" type="number" placeholder="Set Listing Price"
                    class="form-control" min="1" [(ngModel)]="listing_price"
                    [ngClass]="{ 'is-invalid': submitted && f['v_item_list_price'].errors }"
                    onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
                  <div *ngIf="submitted && f['v_item_list_price'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_item_list_price'].errors['required']">Set Listing Price</div>
                    <div style="color: red;" *ngIf="v_item_list_price.errors?.['min']">
                      Minimum 1 Rupee
                    </div>
                  </div>
                </div>

                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Currency<b style="color: red;">*</b></label>
                  <select class="form-control" formControlName="v_currencyid" [(ngModel)]="currency_id">
                    <option value="">-- Select currency --</option>
                    <option *ngFor="let currency of currencylist" [ngValue]="currency.currencyid"
                      [ngClass]="{ 'is-invalid': submitted && f['v_currencyid'].errors }">
                      {{currency.currencyname}}
                    </option>
                  </select>
                  <div *ngIf="submitted && f['v_currencyid'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_currencyid'].errors['required']">Enter Currency</div>
                  </div>
                </div>
                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Quantity<b style="color: red;">*</b></label>
                  <input formControlName="v_quantity" min="1" type="number" class="form-control" [(ngModel)]="quantity"
                    [ngClass]="{ 'is-invalid': submitted && f['v_quantity'].errors }"
                    onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
                  <div *ngIf="submitted && f['v_quantity'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_quantity'].errors['required']">Enter Quantity</div>
                    <div style="color: red;" *ngIf="v_quantity.errors?.['min']">
                      Minimum Quantity 1
                    </div>
                  </div>
                </div>

                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Set Low Inventory<b style="color: red;">*</b></label>
                  <input formControlName="v_min_quantity" type="number" class="form-control" [(ngModel)]="min_quantity"
                    min="1" [ngClass]="{ 'is-invalid': submitted && f['v_min_quantity'].errors }"
                    onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
                  <div *ngIf="submitted && f['v_min_quantity'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_min_quantity'].errors['required']">Set Low Inventory</div>
                    <div style="color: red;" *ngIf="v_min_quantity.errors?.['min']">
                      Minimum Quantity 1
                    </div>
                  </div>
                </div>
                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">SKU<b style="color: red;">*</b></label>
                  <input formControlName="v_sku_id" type="text" (paste)="false" class="form-control" [(ngModel)]="sku"
                    (keypress)="keyPressSpace_1($event)" [ngClass]="{ 'is-invalid': submitted && f['v_sku_id'].errors }">
                  <div *ngIf="submitted && f['v_sku_id'].errors" class="invalid-feedback">
                    <div *ngIf="f['v_sku_id'].errors['required']">Enter SKU</div>
                    <div *ngIf="f['sku_id'].errors && f['sku_id'].errors['pattern']">Enter SKU</div>

                  </div>
                </div>

                <div class="col-12 mt-3 ml-3  mb-3 p-2">
                  <input id="is_perisable" type="checkbox" class="checkbox-template" [(ngModel)]="check_durability"
                    (change)="checkdub()" formControlName="v_checkdurability">
                  <label for="is_perisable" data-bs-toggle="collapse" data-bs-target="#checkdurable"
                    aria-expanded="false" aria-controls="checkdurable">Durable</label>
                </div>
                <div *ngIf="dub_show==true">
                  <div class="row">
                    <div class="col-md-6  mb-3 p-2">
                      <label for="durability_duration" class="form-label">Durable till<b
                          style="color:red ;">*</b></label>
                      <input id="durability_duration" formControlName="v_durability_duration" type="text"
                        name="durability_duration" class="form-control" [(ngModel)]="durability"
                        [ngClass]="{ 'is-invalid': submitted && f['v_durability_duration'].errors }">
                      <div *ngIf="submitted && f['v_durability_duration'].errors" class="invalid-feedback">
                        <div *ngIf="f['v_durability_duration'].errors['required']">Enter Durability</div>
                        <div style="color: red;" *ngIf="v_durability_duration.errors?.['min']">
                          Minimum Value 1
                        </div>
                      </div>

                    </div>
                    <div class="col-md-6  mb-3 p-2">
                      <label class="form-label">Durable type<b style="color:red ;">*</b></label>
                      <select class="form-select" formControlName="v_durableumo" [(ngModel)]="durability_uom"
                        [ngClass]="{ 'is-invalid': submitted && f['v_durableumo'].errors }">
                        <option value="">-- Select Durable type --</option>
                        <option *ngFor="let wtype of warrantytypelist" [ngValue]="wtype.warrantyid">
                          {{wtype.warrantyname}}
                        </option>
                      </select>
                      <div *ngIf="submitted  && f['v_durableumo'].errors" class="invalid-feedback">
                        <div *ngIf="f['v_durableumo'].errors['required']">Select Durable type</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form-group col-12 form-group mb-3">
                  <h6 class="my-3">In The Box(accessories)</h6>
                </div>

                <div>
                  <div class="form-group col-md-12 my-3">
                    <label class="form-label">If this item is containing any accessories along with it, Please mention
                      here.</label>
                    <input type="text" [(ngModel)]="In_the_box" formControlName="v_inthebox" class="form-control"
                      (keypress)="keyPressSpace($event)">
                    <p><small><b>Example</b> Mouse, Keyboard, Adapter</small></p>
                  </div>
                </div>

                <div class="form-group col-12 form-floating mb-3">
                  <h6 class="my-3">Manufacturing Details</h6>
                </div>
                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Manufacturer</label>
                  <textarea formControlName="v_manufacturer_details" class="form-control"
                    [(ngModel)]="manufacture_details" placeholder="Manufacturing Details"
                    oninput="if(!this.value.match('^[a-zA-Z][a-z A-Z 0-9]*$'))this.value='';"
                    (keypress)="keyPressSpace($event)"></textarea>
                </div>
                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Manufacturing Date</label>
                  <input formControlName="v_manufacturing_date" type="date" class="form-control"
                    [(ngModel)]="manufacture_date">
                </div>
                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Expiry Date</label>
                  <input formControlName="v_product_expiry" type="date" class="form-control" [(ngModel)]="expiry_date">
                </div>

                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Country of Origin</label>
                  <select class="form-select" formControlName="v_country" [(ngModel)]="country_origin_id">
                    <option value="">-- Select Country Origin --</option>
                    <option *ngFor="let country of countrylist" [ngValue]="country.countryid">
                      {{country.countryname}}
                    </option>
                  </select>
                </div>

                <div class="col-12  mb-3">
                  <h6 class="my-3">Warrenty Details</h6>
                </div>
                <div class="col-md-6  mb-3 p-2">
                  <label class="form-label">Product Warrenty</label>
                  <input formControlName="v_product_warrent" type="text" placeholder="Product Warrent"
                    class="form-control" [(ngModel)]="warranty">
                </div>
                <div class="col-md-6  mb-3 p-2 ">
                  <label class="form-label">&nbsp;</label>
                  <select class="form-select" formControlName="v_warrantyumo" [(ngModel)]="warranty_uom_id">
                    <option value="" selected>-- Select--</option>
                    <option *ngFor="let wtype of warrantytypelist" [ngValue]="wtype.warrantyid">
                      {{wtype.warrantyname}}
                    </option>
                  </select>
                </div>

                <div class="col-md-6  mb-3 p-2">

                  <input type="file" formControlName="v_imagepic" [(ngModel)]="p_imageurl" accept="image/*"
                    (change)="ItemImageUpload($event)" id="img" #imageInput><br>
                    <b style="color: red;">Note: Image Ratio 1*1, <br> 
                      Image Should Be jpg formate,<br>
                    Image Should Be good Quality</b>

                </div>
                <div class="col-md-6 form-floating mb-3 p-2">
                  <div>
                    <img style="width: 25%;" src="{{imageBaseUrl+p_imageurl}}" class="img-responsive" />
                  </div>
                  <div class="row">
                    <div class="col-6">                 
                      <image-cropper 
                          [imageChangedEvent]="imageChangedEvent"
                          [maintainAspectRatio]="true"
                          [aspectRatio]='1/1'
                          format="png"
                          (imageCropped)="imageCropped($event)"                       
                          (cropperReady)="cropperReady()" 
                          (imageLoaded)="imageLoaded($event)"
                          (loadImageFailed)="loadImageFailed()"
                          id="imagepanel"></image-cropper>              
                    </div>
                    <!-- <div class="col-6">
                      <img [src]="croppedImage"  />
                    </div> -->
              
                   
                  </div>
                </div>
              </div>

              <h5 class="mb-3 mt-5">Shipping Details</h5>
              <!-- {{shippingtypelist|json}} -->

              <div class="form-group" *ngFor="let st of shippingtypelist;let i as index">
                <!-- [(ngModel)]="ship_type" -->
                <div class="form-check" >
                  <input type="radio" class="form-check-input" [attr.id]="'id'+st.ship_typeid"  name="shiptype" value={{st.ship_typeid}} [(ngModel)]="ship_type" (click)="getselcted(st)"  formControlName="shiptype" [checked]="st.ship_typeid===0">
                  <label class="form-check-label" [attr.for]="'id'+st.ship_typeid">{{st.shiptype}}</label>
                </div>
                <div *ngIf="f['shiptype'].touched && f['shiptype'].invalid" class="text-danger">
                    <div *ngIf="f['shiptype'].errors && f['shiptype'].errors['required']">Please select shipping type</div>
                </div>
              </div>
           


              <div class="col-lg-12 mt-4">
                <div class="text-center">
                  <input type="text" [(ngModel)]="item_id" [hidden]="true" />

                  <a type="submit" class="btn btn-template wide next" (click)="editForm()">
                    Update<i class="fa fa-angle-right"></i>
                  </a> &nbsp;
                  <a type="submit" class="btn btn-template wide next" (click)="nextForm()">
                    Next<i class="fa fa-angle-right"></i>
                  </a>
                </div>
              </div>

            </form>
          </div>
          <div class="row mt-2" *ngFor="let val of validation_list">
            <div class="col-md-9" style="color:red">{{val}}</div>
          </div>
        </div>
      </div>


      <div class="col-md-4" *ngIf="product_details.length>0">
        <div class="block-body order-summary">

          <h6 class="text-uppercase">
            {{product_details[0].productname}}
          </h6>
          <p>{{product_details[0].shortdescription}}</p>
          <ul class="order-menu list-unstyled">
            <li class="d-flex justify-content-between">
              <span>Base Price</span>
              <span><strong>Rs {{product_details[0].baseprice}}</strong></span>
            </li>

            <li class="d-flex justify-content-between">
              <img src={{imageBaseUrl+product_details[0].imagepath}} width="100%" height="auto" />
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>
